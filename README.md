![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)
![Python 3.7](https://img.shields.io/badge/python-3.7-blue.svg)
![pytest](https://github.com/lucaslehnert/rlutils/workflows/pytest/badge.svg)

# Reward-Predictive State Representations Generalize Across Task

This repository contains the implementations to reproduce the simulation results of [Lehnert et al. 2020][paper].
Please view the individual jupyter notebook files for instructions on how to reproduce all results.

## Datasets and Reproduction With Docker

This repository and all data generated by the implemented simulations can also be downloaded as a [Docker][docker] 
container form [Docker Hub][dockerhub]. This Docker container also contains all software needed to run the notebooks and implemented 
experiments. Note that the container has a size of 12.9GB.

To use the containers, first install Docker on your computer and then download the container:

```angular2
docker pull lucasdocker/rewardpredictive
```

Then the container can be run with

```angular2
docker run -it -p 8888:8888 lucasdocker/rewardpredictive:latest
```

Then point your browser to localhost:8888 to access the jupyter notebook server.
The Docker container can also be used to reproduce each simulation by running

```angular2
docker run -it lucasdocker/rewardpredictive:latest python -m main -e [ExperimentName]
```

The included simulation data can be extracted by running

```angular2
docker cp [CONTAINER]:/workdir/rewardpredictive/data [DEST_PATH]
```

where `[CONTAINER]` is the container ID of the downloaded container and `[DEST_PATH]` is the path location where the 
data will be copied on the host.

## Installation and Running Code

To run the jupyter notebooks and reproduce the simulations, first clone the repository, create a python 3.7 virtual environment, and install the required 
dependencies:

```
git clone https://github.com/lucaslehnert/rewardpredictive.git
cd rewardpredictive
pip install -r requirements.txt
```

The jupyter notebooks can be viewed by running 

```
jupyter notebook
```

from the project's root directory (the directory this README file is stored in).
All simulations can be reproduced by running the main script from the root directory:

```
python -m main -e [ExperimentName]
```

[paper]: https://www.biorxiv.org/content/10.1101/653493v2
[docker]: https://www.docker.com/
[dockerhub]: https://hub.docker.com/r/lucasdocker/rewardpredictive
